â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘         AbstractVoice CLI Flow Diagrams & Architecture Guide               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
1. ENTRY POINT ROUTING (pyproject.toml Configuration)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    User Command                Package Entry Point                Handler
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”€â”€â”€â”€â”€â”€â”€â”€

    abstractvoice          â†’    voice_cli.py:main           â†’     VoiceREPL
    â”œâ”€ --model             |    (Voice Mode)               |      (from cli_repl.py)
    â”œâ”€ --api               |                               |      Direct Ollama
    â”œâ”€ --language          |                               |      Integration
    â””â”€ --debug             |                               â””â”€â†’    REPL cmdloop()

    abstractvoice-cli      â†’    __main__.py:main           â†’      Example
    â”œâ”€ cli                 |    (Dispatcher)               |      Dispatcher
    â”œâ”€ web                 |                               |      Route to:
    â”œâ”€ simple              |                               â”œâ”€â†’    cli_repl.py:main
    â””â”€ check-deps          |                               â”œâ”€â†’    web_api.py:main
                           |                               â”œâ”€â†’    simple_example()
                           |                               â””â”€â†’    check_dependencies()

    python -m abstractvoice â†’   __main__.py (as module)    â†’      Example
    â”œâ”€ check-deps          |    (Dispatcher)               |      Dispatcher
    â”œâ”€ simple              |                               |      (same as above)
    â””â”€ cli                 |                               â””â”€â†’    Route to examples


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2. VOICE MODE FLOW (abstractvoice command)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    START: abstractvoice [options]
           â”‚
           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ parse_args() in voice_cli.py â”‚  Parse CLI arguments
    â”‚ - model (def: granite3.3:2b) â”‚  - api URL
    â”‚ - language                   â”‚  - temperature
    â”‚ - debug mode                 â”‚  - etc.
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Initialize VoiceREPL object      â”‚  Create REPL instance
    â”‚ (from cli_repl.py)               â”‚  - Initialize voice_manager
    â”‚                                  â”‚  - Set model, API, language
    â”‚ VoiceManager initialization:     â”‚  - Load system prompt
    â”‚  â”œâ”€ TTS Engine (lazy import)     â”‚
    â”‚  â”œâ”€ STT Recognizer (lazy import) â”‚
    â”‚  â””â”€ VAD Engine                   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ repl.cmdloop()                   â”‚  Start interactive REPL
    â”‚ - Displays welcome message       â”‚
    â”‚ - Shows available commands       â”‚
    â”‚ - Waits for user input           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
         â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
         â”‚           â”‚
         â†“           â†“
    User input   User commands
    (text)       (starting with /)
         â”‚           â”‚
         â†“           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ process_query()                 â”‚  /voice, /model, /language,
    â”‚ Send to Ollama API:             â”‚  /setvoice, /help, etc.
    â”‚                                 â”‚
    â”‚ 1. Add message to history       â”‚  â†’ Handle specific commands
    â”‚ 2. Create JSON payload:         â”‚     (execute immediately)
    â”‚    {                            â”‚
    â”‚      "model": "granite3.3:2b",  â”‚
    â”‚      "messages": [...],         â”‚
    â”‚      "temperature": 0.4,        â”‚
    â”‚      "max_tokens": 4096         â”‚
    â”‚    }                            â”‚
    â”‚ 3. POST to Ollama at:           â”‚
    â”‚    http://localhost:11434/      â”‚
    â”‚    api/chat                     â”‚
    â”‚ 4. Wait for response            â”‚
    â”‚ 5. Parse JSON response          â”‚
    â”‚ 6. Extract assistant content    â”‚
    â”‚ 7. Print response               â”‚
    â”‚ 8. Speak via voice_manager      â”‚
    â”‚                                 â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
         â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
         â”‚             â”‚
         â†“             â†“
    Continue Loop    Exit (/exit)
         â”‚             â”‚
         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
        CLEANUP & END


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
3. OLLAMA API INTEGRATION (Detailed Request/Response)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    AbstractVoice              HTTP Network           Ollama Server
    Client Code                 Boundary              (Port 11434)
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    User types: "Hello"
         â”‚
         â†“
    payload = {
      "model": "granite3.3:2b",
      "messages": [
        {"role": "system", "content": "You are a helpful assistant..."},
        {"role": "user", "content": "Hello"}
      ],
      "stream": false,
      "temperature": 0.4,
      "max_tokens": 4096
    }
         â”‚
         â†“ requests.post()
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ POST /api/chat                         â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’  Receives request
    â”‚ Host: localhost:11434                  â”‚
    â”‚ Content-Type: application/json         â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’  Loads model
    â”‚ [JSON payload above]                   â”‚
    â”‚                                        â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’  Generates response
    â”‚                                        â”‚
    â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  Sends response
    â”‚ HTTP/1.1 200 OK                        â”‚
    â”‚ Content-Type: application/json         â”‚
    â”‚                                        â”‚
    â”‚ {                                      â”‚
    â”‚   "model": "granite3.3:2b",            â”‚
    â”‚   "created_at": "2024-10-19T...",      â”‚
    â”‚   "message": {                         â”‚
    â”‚     "role": "assistant",               â”‚
    â”‚     "content": "Hello! How can I help?"â”‚
    â”‚   },                                   â”‚
    â”‚   "done": true,                        â”‚
    â”‚   "prompt_eval_count": 15,             â”‚
    â”‚   "eval_count": 23                     â”‚
    â”‚ }                                      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
    Parse JSON response
         â†“
    Extract: response_data["message"]["content"]
         â†“
    Add to message history
         â†“
    Print to console
         â†“
    Call voice_manager.speak(response)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
4. ERROR HANDLING FLOW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    INITIALIZATION ERRORS:
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    Missing TTS Dependencies
         â”‚
         â†“ (on voice_manager.speak())
    lazy import tries to load TTSEngine
         â”‚
         â†“ ImportError caught
    â””â”€â†’  Helpful error message:
         "TTS functionality requires optional dependencies.
          Install with: pip install abstractvoice[tts]"


    OLLAMA CONNECTION ERRORS:
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    requests.post(api_url, json=payload)
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚          â”‚
    Connection  â”‚ Success
    Error       â”‚  â”‚
    â”‚           â”‚  â†“
    â†“           HTTP 200
    â”‚           â”‚
    â”œâ”€â†’ ConnectionError â”œâ”€â†’ Parse response
        caught      â”‚
    â”‚              â”œâ”€â†’ Check format:
    â””â”€â†’ Print:          - Ollama format
        "Error:          - OpenAI format
         [errno]"        - Other format


    MODEL NOT FOUND ERRORS:
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    requests.post() with non-existent model
         â”‚
         â†“
    Ollama returns error (usually 404 or 400)
         â”‚
         â†“ response.raise_for_status()
    HTTPError raised
         â”‚
         â†“ except Exception as e:
    Caught in generic handler
         â”‚
         â†“
    Print: "Error: 404 Client Error: Not Found for url: ..."
         â”‚
         â†“ (if --debug)
    Print full traceback


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
5. DEPENDENCY CHECK FLOW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    Command: python -m abstractvoice check-deps
    or: abstractvoice-cli check-deps
             â”‚
             â†“
    __main__.py:main()
             â”‚
             â†“ parse arguments
    args.example == "check-deps"
             â”‚
             â†“
    from abstractvoice.dependency_check import check_dependencies
    check_dependencies(verbose=True)
             â”‚
             â†“
    Create DependencyChecker instance
             â”‚
             â”œâ”€â†’ check_core_dependencies()
             â”‚   â”œâ”€ numpy
             â”‚   â””â”€ requests
             â”‚
             â”œâ”€â†’ check_pytorch_ecosystem()
             â”‚   â”œâ”€ torch
             â”‚   â”œâ”€ torchvision
             â”‚   â””â”€ torchaudio
             â”‚
             â”œâ”€â†’ check_optional_dependencies()
             â”‚   â”œâ”€ coqui-tts
             â”‚   â”œâ”€ openai-whisper
             â”‚   â”œâ”€ sounddevice
             â”‚   â”œâ”€ librosa
             â”‚   â”œâ”€ flask
             â”‚   â”œâ”€ webrtcvad
             â”‚   â”œâ”€ PyAudio
             â”‚   â”œâ”€ soundfile
             â”‚   â””â”€ tiktoken
             â”‚
             â””â”€â†’ check_pytorch_conflicts()
                 â””â”€ Detect known version incompatibilities
                 â”‚
                 â†“
    For each: importlib.import_module(package)
             â”‚
             â”œâ”€ SUCCESS: version = module.__version__
             â”‚           compare against range
             â”‚           report: âœ… installed, compatible
             â”‚
             â””â”€ FAILURE: report: âŒ missing/incompatible
                         suggest fix
                 â”‚
                 â†“
    Print formatted report:
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ ğŸ” Dependency Check Report â”‚
    â”‚ âœ… numpy: v1.24.3         â”‚
    â”‚ âŒ torch: not installed    â”‚
    â”‚ âš ï¸  flask: v2.0.1 (old)    â”‚
    â”‚                            â”‚
    â”‚ ğŸ’¡ Recommendations:        â”‚
    â”‚    pip install [packages]  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
6. PARAMETER FLOW THROUGH SYSTEM
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    abstractvoice --model mistral --temperature 0.7 --language fr
         â”‚
         â”œâ”€ --model mistral
         â”‚  â””â”€â†’ voice_cli.py:parse_args()
         â”‚     â””â”€â†’ args.model = "mistral"
         â”‚        â””â”€â†’ VoiceREPL(model="mistral")
         â”‚           â””â”€â†’ self.model = "mistral"
         â”‚              â””â”€â†’ Used in every API request
         â”‚
         â”œâ”€ --temperature 0.7
         â”‚  â””â”€â†’ parse_args()
         â”‚     â””â”€â†’ args.temperature = 0.7
         â”‚        â””â”€â†’ VoiceREPL(temperature=0.7)
         â”‚           â””â”€â†’ self.temperature = 0.7
         â”‚              â””â”€â†’ payload["temperature"] = 0.7
         â”‚
         â””â”€ --language fr
            â””â”€â†’ parse_args()
               â””â”€â†’ args.language = "fr"
                  â””â”€â†’ VoiceREPL(language="fr")
                     â””â”€â†’ voice_manager.set_language("fr")
                        â””â”€â†’ Loads French TTS model
                           â””â”€â†’ All speak() calls use French


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
7. MESSAGE HISTORY & CONTEXT MAINTENANCE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    VoiceREPL.__init__()
         â”‚
         â†“
    self.messages = [
      {"role": "system", "content": "You are a helpful voice assistant..."}
    ]
         â”‚
         User: "Hello"
         â”‚
         â†“ process_query("Hello")
    self.messages.append({"role": "user", "content": "Hello"})
         â”‚
         self.messages = [
           {"role": "system", ...},
           {"role": "user", "content": "Hello"}
         ]
         â”‚
         â†“ POST all messages to Ollama
         â”‚
         Ollama Response: "Hi there! How can I help?"
         â”‚
         â†“ parse response
    self.messages.append({"role": "assistant", "content": "Hi there!..."})
         â”‚
         self.messages = [
           {"role": "system", ...},
           {"role": "user", "content": "Hello"},
           {"role": "assistant", "content": "Hi there!..."}
         ]
         â”‚
         User: "What's the weather?"
         â”‚
         â†“ process_query("What's the weather?")
         â”‚
         â†“ POST all 3 messages to Ollama
         Ollama sees conversation history
         Responds in context


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
8. VOICE MODE STATE TRANSITIONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    START
      â”‚
      â†“
    voice_mode = "off"
    voice_mode_active = False
      â”‚
      â”‚ User: /voice wait
      â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ VOICE ENABLED  â”‚ â†â”€â”€â”€â”€ /voice full, wait, stop, ppt
    â”‚ (Listening on) â”‚
    â”‚ voice_mode_active = True
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”œâ”€â†’ Voice detected (VAD)
             â”‚   â”‚
             â”‚   â†“
             â”‚  Speech-to-text
             â”‚  (Whisper)
             â”‚   â”‚
             â”‚   â†“
             â”‚  _voice_callback(text)
             â”‚   â”‚
             â”‚   â†“
             â”‚  Process message
             â”‚   â”‚
             â”‚   â†“
             â”‚  If text == "stop"
             â”‚   â”‚
             â”‚   â””â”€â†’ _voice_stop_callback()
             â”‚       â”‚
             â”‚       â†“
             â”‚   voice_mode = "off"
             â”‚   voice_mode_active = False
             â”‚       â”‚
             â”‚       â””â”€â”€â”€â”€â†’ Back to listening
             â”‚
             â””â”€â†’ User: /voice off
                 â”‚
                 â†“
             stop_listening()
                 â”‚
                 â†“
             voice_mode_active = False


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
9. TTS/STT INTERACTION FLOW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    process_query(user_text)
         â”‚
         â†“
    Ollama generates response
         â”‚
         â†“
    If use_tts == True:
         â”‚
         â”œâ”€â†’ voice_manager.speak(response_text)
         â”‚   â”‚
         â”‚   â”œâ”€â†’ Convert text to speech (Coqui-TTS)
         â”‚   â”‚
         â”‚   â”œâ”€â†’ Play audio file (sounddevice)
         â”‚   â”‚
         â”‚   â””â”€â†’ Set is_speaking() = True
         â”‚
         â””â”€â†’ While speaking:
             â”‚
             â””â”€â†’ If user speaks (VAD detected):
                 â”‚
                 â”œâ”€â†’ Interrupt TTS
                 â”‚
                 â””â”€â†’ Listen (in "full" mode)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
10. KEY FILES & THEIR RESPONSIBILITIES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    pyproject.toml
    â”œâ”€ Defines CLI entry points
    â”œâ”€ abstractvoice â†’ voice_cli.py:main
    â””â”€ abstractvoice-cli â†’ __main__.py:main

    __main__.py
    â”œâ”€ Example dispatcher
    â”œâ”€ Routes commands to examples
    â”œâ”€ Handles: cli, web, simple, check-deps
    â””â”€ DOES NOT handle direct voice mode

    voice_cli.py
    â”œâ”€ Voice mode entry point
    â”œâ”€ Parses CLI arguments
    â”œâ”€ Initializes VoiceREPL
    â”œâ”€ Direct Ollama integration
    â””â”€ DOES NOT handle examples/utilities

    cli_repl.py
    â”œâ”€ VoiceREPL class (interactive REPL)
    â”œâ”€ Ollama API interaction (requests)
    â”œâ”€ Message history management
    â”œâ”€ REPL commands implementation
    â””â”€ Voice manager integration

    voice_manager.py
    â”œâ”€ High-level voice orchestration
    â”œâ”€ TTS engine wrapper
    â”œâ”€ STT recognizer wrapper
    â”œâ”€ Language management
    â””â”€ Voice activity detection

    dependency_check.py
    â””â”€ Validates all dependencies


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Last Updated: 2024-10-19
